<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet"
	href="../bower_components/bootstrap/dist/css/bootstrap.min.css">
<link rel="stylesheet"
	href="../bower_components/bootstrap/dist/css/bootstrap-theme.min.css">
<link href='https://fonts.googleapis.com/css?family=Oswald'
	rel='stylesheet' type='text/css'>
<link rel="stylesheet"
	href="../bower_components/jquery-ui/themes/smoothness/jquery-ui.css">
<style>
#container-fluid {
	overflow: hidden;
	width: 100%;
	min-width: 980px;
	height: 50px;
	margin: 15px 60px 15px 10px;
}

#container-fluid>#logo {
	font-size: large;
	display: inline-block;
	color: purple;
	padding-top: 2px;
	margin-top: 10px;
}

#container-fluid>#logo:HOVER {
	background-color: white;
}

#container-fluid>#menu2 {
	float: right;
	display: inline-block;
	position: relative;
	cursor: pointer
}

#container-fluid>#menu2>* {
	display: inline-block;
	position: relative;
	width: 130px;
	text-align: center;
	margin-top: 14px;
}

#container-fluid>#menu2>*:HOVER {
	background-color: black;
	color: white;
}

#t1>video {
	border: 1px solid red;
	width: 60%;
	height: 40%;
	margin: 0 auto;
}

#footer {
	border: 1px solid white;
	margin: 5px;
	text-align: center;
}

#img {
	margin: 50px;
}

#btn1, #btn2, #btn3, #btn4 {
	cursor: pointer;
}
</style>
</head>
<body>

	<div id='container-fluid'>
		<div id='logo'>S e o k W o n S o n g</div>
		<div id="menu2">
			<div id='home'>HOME</div>
			<div id='sing' onclick='location.href="../sing/sing.html"'>SING</div>
			<div id='songs' onclick='location.href="../songs/song.html"'>SONGS</div>
			<div id='hof' onclick='location.href="../halloffame/halloffame.html"'>HALL
        OF FAME</div>
			<div id='songs'>MY SONGS</div>
			<div id='logout'>LOGOUT</div>
		</div>
	</div>

	<div id="t1" align="center"></div>

	<div id="footer">
		<div style="display: inline-block;">
			<img id='btn1' src="../picture/녹음.png">
		</div>
		<div style="display: inline-block;">
			<img id='btn2' src="../picture//재생.png" alt="재생">
		</div>

		<div style="display: inline-block;">
			<img id='btn3' src="../picture/일시정지.png" alt="일시정지">
		</div>

		<div style="display: inline-block;">
			<img id='btn4' src="../picture/저장.png" alt="저장">
		</div>
	</div>

	<div id="desc" style="text-align: center">
		<img id="img1" src="../picture/설명.jpg" alt="녹음설명" />
	</div>

	<script src="../bower_components/p5.js/lib/p5.js"></script>
	<script src="../bower_components/p5.js/lib/addons/p5.sound.js"></script>
	<script src="../bower_components/p5.js/lib/addons/p5.dom.js"></script>
	<script>
		var mic, recorder, soundFile;
		var state = 0;

		function setup() {
			mic = new p5.AudioIn();
			mic.start();
			recorder = new p5.SoundRecorder();
			recorder.setInput(mic);
			soundFile = new p5.SoundFile();
		}

		var btn1 = document.querySelector("#btn1")
		var d2 = document.querySelector("#t1")
		btn1.addEventListener(
			"click",
			function(event) {
				if (state === 0 && mic.enabled) {
				document.querySelector("#desc").removeChild(
						document.querySelector("#img1"))
				d2.innerHTML = "<p align='center'><iframe id='playing' width='854' height='480' "
						+ "src='https://www.youtube.com/embed/" + sessionStorage.getItem('youtube') + "?autoplay=1&controls=0&disablekb=1&rel=0&showinfo=0&modestbranding=1'"
						+ " frameborder='0'></iframe>"
	        recorder.record(soundFile);
	        state = 1;
	      } else if (state === 1) {
	        recorder.stop();
	        state = 2;
	        alert("녹음이 완료 되었습니다. 한번 더 누르면 저장 가능합니다.")
	      } else if (state === 2) {
	    	  recorder.record(soundFile);
	    	  state = 1;
	      }
			});

		btn2.addEventListener("click", function(event) {
      if (state === 2) {
        soundFile.play(); 
      } else {
        alert ("녹음된 노래가 없습니다.")
      }
    });
		
		btn3.addEventListener("click", function(event) {
      if (state === 2) {
        soundFile.stop(); 
      } else {
        alert ("녹음된 노래가 없습니다.")
      }
    });
		
		btn4.addEventListener("click", function(event) {
			if (state === 2) {
        saveSound(soundFile, fileName());
        alert(title)
        state = 0;
      } else {
    	  alert ("녹음된 노래가 없습니다.")
      }
		});
		
		
		function fileName() {
			var today = new Date();
			var dd = today.getDate();
			var mm = today.getMonth()+1;
			var yyyy = today.getFullYear();
			var hh = today.getHours();
			var MM = today.getMinutes();
			var ss = today.getSeconds();
			if(dd<10) {
			    dd='0'+dd
			} 
			if(mm<10) {
			    mm='0'+mm
			} 
			if(hh<10) {
				hh='0'+hh
			}
			if(MM<10) {
				MM='0'+MM
			}
			if(ss<ss) {
				ss='0'+ss
			}
			today = yyyy+mm+dd+hh+MM+ss;
			return today.toString()
		}
	</script>
</html>